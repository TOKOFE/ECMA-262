# ECMA-262-3 세부 사항. 제3장. `This`
Source: [http://dmitrysoshnikov.com/ecmascript/chapter-3-this/](http://dmitrysoshnikov.com/ecmascript/chapter-3-this/)

## 소개

이번 장에서는 실행 컨텍스트와 밀접한 관련이 있는 `this` 키워드에 대해서 설명한다. `this`가 정확히 어떤 값을 갖는지 이해하는것은 실제로 어려운 주제이며 개발자들이 종종 혼동하는 부분이다.

대부분의 개발자들은 프로그래밍 언어에서 `this` 키워드가 객체지향 프로그래밍과 밀접한 관련이 있다고 알고있다. 좀 더 정확히 말하자면, 함수의 생성자에 의해 만들어진 인스턴스를 참조하는것으로 이해한다. 이러한 개념은 ECMAScript 에도 구현되어 있는데 앞으로 자세히 살펴보겠지만 ECMAScript에서는 단순히 생성된 인스턴스만 참조하는것으로 제한되지 않는다.

그럼 지금부터 ECMAScript에서는 `this`의 값이 정확히 무엇을 참조하는지 알아보자.

## 정의
`this` 는 실행 컨텍스에서 하나의 프러퍼티라 할 수 있다.

```
activeExecutionContext = {
 VO: {...},
 this: thisValue
};
```

여기서 VO는 이전 장에서 설명했던 변수 객체(Varialbe Object)이다. 컨텍스트에서 `this`가 어떤 값을 갖는지는 코드가 어떤 방식으로 실행되는가에 따라 달라진다. 다른의미로 하면, 프로그램 컨트롤이 컨텍스트에 진입하는 시점 즉, 함수가 호출되는 시점에 따라 `this`의 값이 달라진다. 이때 그 값은 그 컨텍스트에서 코드가 실행되는 동안 변경되지 않는다.

그럼 코드가 어떤 방식으로 실행되는지에 대해 좀 더 자세히 알아보자.

## 전역 코드(Global Code)에서 this의 값

이 경우는 간단하게 결정될 수 있다. 전역 코드에서 `this`의 값은 항상 전역 객체 자신이 되며, `this`를 통하지 않고도 참조 될 수 있다.

```
// 명시적으로 전역 객체에 프러퍼티를 정의
this.a = 10; // global.a = 10
alert(a); // 10
 
// var 키워드로 명시 되지 않은 변수에 값을 지정하는 암묵적인 정의 
b = 20;
alert(this.b); // 20
 
// 명시적인 변수 선언을 통한 암묵적 정의
// 전역 컨텍스트에 선언된 변수는 전역 객체에 속하기 때문이다.
var c = 30;
alert(this.c); // 30
```

## 함수코드에서 this의 값

`this`가 함수에서 사용될 때는 흥미롭기는 하지만 좀 복잡하다. 사실 가장 이해하기 어려운 부분이면서 또한 여러 이슈들의 원인이기도 하다. 첫번째 (아마 가장 중요한) 특징은 `this`가 함수에 statically 바인딩되지 않는다는 것이다. 위에서 언급했듯이 `this`는 컨텍스에 진입하는 시점에 결정되는데 함수에서 사용될때는 상황에 따라서 달라지게 된다. 
실행시 `this`는 변경될수 없기때문에 새로운 값을 할당할 수 없다 (반대로 Python 프로그래밍에서는 self 객체를 정의할 수 있는데 이것은 실행시 반복적으로 변경할 수 있다)

```
var foo = {x: 10};
 
var bar = {
  x: 20,
  test: function () {
 
    alert(this === bar); // true
    alert(this.x); // 20
     
    this = foo;    // 오류, this 값을 변경할 수 없다
  
    alert(this.x); // 만약 오류가 없으면 20이 아니라 10이 된다
 
  }
 
};
 
// 컨텍스에 진입하는 시점에 `this`는
// "bar" 객체가 된다. object; 
// 왜 그런지는 아래에서 좀 더 자세히 설명하고자 한다.
 
bar.test(); // true, 20
 
foo.test = bar.test;
 
// 같은 함수를 호출하고 있지만
// 여기서 `this` 는 "foo" 객체가 된다.
 
foo.test(); // false, 10
```
